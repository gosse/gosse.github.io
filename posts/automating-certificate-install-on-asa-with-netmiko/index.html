<!doctype html><html lang=en-us><head><meta charset=utf-8><title>Automating Certificate Install on ASA with Netmiko</title><meta name=description content><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><link rel=alternate type=application/rss+xml href=https://gosse.github.io/index.xml title=next-hop-self><meta name=twitter:card content="summary"><meta name=twitter:title content="Automating Certificate Install on ASA with Netmiko"><meta name=twitter:description content="Here is a little script I wrote to automate putting certificates onto ASAs. It also activates the cert on the inside interface (mine is a one-armed VPN concentrator). The cert is assumed to already in the correct format and named asabase64.cert.
#!/usr/bin/env python3 from netmiko import Netmiko import base64 import datetime # connection config for netmiko asav = { &#34;host&#34;: &#34;hostname&#34;, &#34;username&#34;: &#34;user&#34;, &#34;password&#34;: &#34;pass&#34;, &#34;device_type&#34;: &#34;cisco_asa&#34;, &#34;secret&#34;: &#34;enable secret&#34; } # open and read the cert with open(&#34;asabase64."><link rel=stylesheet href=https://gosse.github.io/fontawesome/css/all.min.css><link crossorigin=anonymous href=/css/styles.min.css integrity rel="preload stylesheet" as=style><link id=dark-mode-theme crossorigin=anonymous href=/css/dark.min.css integrity rel="preload stylesheet" as=style><script>var darkTheme=document.getElementById("dark-mode-theme"),storedTheme=localStorage.getItem("dark-mode-storage");storedTheme==="dark"?darkTheme.disabled=!1:storedTheme==="light"&&(darkTheme.disabled=!0)</script><script defer crossorigin=anonymous src=/js/theme.js integrity></script>
<script defer crossorigin=anonymous src=/js/instantpage.min.js integrity></script><meta name=generator content="Hugo 0.101.0"></head><body><header><nav class=navbar><div class=nav><a href=https://gosse.github.io/ class=nav-logo><img src=https://gosse.github.io/images/icon.png width=50 height=50 alt=Logo></a><ul class=nav-links><li><a href=/about/ id=About><em class="fas fa-user fa-lg"></em></a></li><li><a href=/tags id=Tags><em class="fas fa-tag fa-lg"></em></a></li><li><a href=/categories id=Category><em class="fas fa-folder-open fa-lg"></em></a></li></ul></div></nav><div class=intro-header><div class=container><div class=posts-heading><h1>Automating Certificate Install on ASA with Netmiko</h1></div></div></div></header><div class=container role=main><article class=article class=blog-post><p>Here is a little script I wrote to automate putting certificates onto ASAs. It also activates the cert on the inside interface (mine is a one-armed VPN concentrator). The cert is assumed to already in the correct format and named asabase64.cert.</p><pre tabindex=0><code>#!/usr/bin/env python3

from netmiko import Netmiko
import base64
import datetime

# connection config for netmiko 
asav = {
&#34;host&#34;: &#34;hostname&#34;,
&#34;username&#34;: &#34;user&#34;,
&#34;password&#34;: &#34;pass&#34;,
&#34;device_type&#34;: &#34;cisco_asa&#34;,
&#34;secret&#34;: &#34;enable secret&#34;
}

# open and read the cert 
with open(&#34;asabase64.cert&#34;, &#34;r&#34;) as f: 
cert = f.read().splitlines()

# name the cert with today&#39;s date 
# this helps when pushing a new cert 
# to not have a namespace overlap 
today = datetime.datetime.now().strftime(&#34;%d-%m-%Y&#34;)
certname = today + &#34;starcert&#34;
certcmd = &#34;crypto ca import &#34; + certname + &#34; pkcs12 asaexportpass&#34;
# build the commands needed to install the cert
commands = []
commands.append(&#34;conf t&#34;)
commands.append(certcmd)
commands = commands + cert
commands.append(&#34;&#34;)
commands.append(&#34;quit&#34;)
trustpoint = &#34;ssl trust-point &#34; + certname + &#34; inside&#34;
commands.append(trustpoint)

# connect to the firewall 
net_connect = Netmiko(**asav)
print(net_connect.find_prompt())

# always a good test 
output = net_connect.send_command_timing(&#34;show int ip br&#34;)

# send the commands
for command in commands:
print(command)
net_connect.send_command_timing(command)


# clean up 
net_connect.disconnect()
</code></pre><div class=blog-tags><a href=https://gosse.github.io/tags/asa/>asa</a>&nbsp;
<a href=https://gosse.github.io/tags/automation/>automation</a>&nbsp;
<a href=https://gosse.github.io/tags/cisco/>cisco</a>&nbsp;
<a href=https://gosse.github.io/tags/networking/>networking</a>&nbsp;
<a href=https://gosse.github.io/tags/security/>security</a>&nbsp;</div></article></div><footer><div class=social-icons><a href=https://www.linkedin.com/in/gossew/ name=LinkedIn><em class="fab fa-linkedin"></em></a>
&nbsp;&ndash;&nbsp;
<a href=https://github.com/gosse name=GitHub><em class="fab fa-github"></em></a>
&nbsp;&ndash;&nbsp;
<a href=https://twitter.com/gossewaa name=Twitter><em class="fab fa-twitter"></em></a></div><div class=container><p class="credits copyright"><a href=https://gosse.github.io/about>Gary Ossewaarde</a>
&nbsp;&copy;
2021
&nbsp;/&nbsp;
<a href=https://gosse.github.io/>next-hop-self</a>
&nbsp;&ndash;&nbsp;
<em class="fas fa-moon" id=dark-mode-toggle></em></p><p class="credits theme-by"><a href=https://gohugo.io>Hugo</a>&nbsp;
<a href=https://github.com/matsuyoshi30/harbor>Harbor</a></p></div></footer></body></html>